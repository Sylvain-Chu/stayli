{{> header }}
{{> sidebar }}

<h1>{{t 'bookings.title'}}</h1>
<form method='GET' action='/bookings' style='margin: 0 0 1rem;'>
  <label>{{t 'common.from'}}
    <input type='date' name='from' value='{{from}}' />
  </label>
  <label style='margin-left:.5rem;'>{{t 'common.to'}}
    <input type='date' name='to' value='{{to}}' />
  </label>
  <button type='submit' style='margin-left:.5rem;'>{{t 'common.filter'}}</button>
  {{#if from}}{{#if to}}<a href='/bookings' style='margin-left: .5rem;'>{{t 'common.clear'}}</a>{{/if}}{{/if}}
  <span style='margin-left:1rem;'><a href='/bookings/create'>{{t 'bookings.addNew'}}</a> | <a href='/bookings/calendar'>{{t 'bookings.openCalendar'}}</a></span>
  </form>
<hr />
<ul>
  {{#each bookings}}
    <li>
      <strong>{{this.property.name}}
        —
        {{this.client.firstName}}
        {{this.client.lastName}}</strong><br />
      <small>{{date this.startDate}}
        →
        {{date this.endDate}}
        —
        {{this.totalPrice}}€ —
        {{this.status}}</small>
      
      <div class="action-group">
        {{#if this.canDelete}}
          <button
            data-delete
            data-id='{{this.id}}'
            data-base='/bookings'
            data-confirm='{{t "bookings.confirmDelete"}}'
          >{{t 'common.delete'}}</button>
        {{else}}
          <span class="action-wrap">
            <button class="btn-disabled" aria-disabled="true" aria-describedby="reason-delete-{{this.id}}" tabindex="-1">{{t 'common.delete'}}</button>
            <span id="reason-delete-{{this.id}}" class="btn-reason" role="tooltip">{{t this.canDeleteReason}}</span>
          </span>
        {{/if}}

        {{#if this.canCancel}}
          <button
            data-post
            data-url='/bookings/{{this.id}}/cancel'
            data-confirm='{{t "bookings.confirmCancel"}}'
          >{{t 'common.cancel'}}</button>
        {{else}}
          <span class="action-wrap">
            <button class="btn-disabled" aria-disabled="true" aria-describedby="reason-cancel-{{this.id}}" tabindex="-1">{{t 'common.cancel'}}</button>
            <span id="reason-cancel-{{this.id}}" class="btn-reason" role="tooltip">{{t this.canCancelReason}}</span>
          </span>
        {{/if}}

        <a href='/bookings/{{this.id}}'>{{t 'common.view'}}</a>

        {{#if this.canEdit}}
          <a href='/bookings/{{this.id}}/edit'>{{t 'common.edit'}}</a>
        {{else}}
          <span class="action-wrap">
            <span class="link-disabled" aria-disabled="true" aria-describedby="reason-edit-{{this.id}}" tabindex="-1">{{t 'common.edit'}}</span>
            <span id="reason-edit-{{this.id}}" class="btn-reason" role="tooltip">{{t this.canEditReason}}</span>
          </span>
        {{/if}}
      </div>
    </li>
  {{else}}
    <li>{{t 'bookings.noBookings'}}</li>
  {{/each}}
</ul>

{{> footer }}