{{> header }}
{{> sidebar }}

<h1>Edit booking</h1>
{{#if errors}}
  <div class='alert alert-error'>
    <ul>
      {{#each errors}}
        <li>{{this}}</li>
      {{/each}}
    </ul>
  </div>
{{/if}}
<form method='post' action='/bookings/{{booking.id}}/edit'>
  <div>
    <label>Property</label>
    <select name='propertyId' required>
      {{#each properties}}
        <option value='{{this.id}}' {{#if (eq this.id ../(or payload.propertyId ../booking.propertyId))}}selected{{/if}}>
          {{this.name}}
        </option>
      {{/each}}
    </select>
  </div>
  <div>
    <label>Client</label>
    <select name='clientId' required>
      {{#each clients}}
        <option value='{{this.id}}' {{#if (eq this.id ../(or payload.clientId ../booking.clientId))}}selected{{/if}}>
          {{this.lastName}} {{this.firstName}} - {{this.email}}
        </option>
      {{/each}}
    </select>
  </div>
  <div>
    <label>Start Date</label>
    <input type='date' name='startDate' value='{{#if payload.startDate}}{{payload.startDate}}{{else}}{{date booking.startDate}}{{/if}}' required />
  </div>
  <div>
    <label>End Date</label>
    <input type='date' name='endDate' value='{{#if payload.endDate}}{{payload.endDate}}{{else}}{{date booking.endDate}}{{/if}}' required />
  </div>
  <div>
    <label>Total Price</label>
    <input type='number' step='0.01' name='totalPrice' value='{{#if payload.totalPrice}}{{payload.totalPrice}}{{else}}{{booking.totalPrice}}{{/if}}' />
  </div>
  <div>
    <label>Status</label>
    <select name='status'>
      {{#with (or payload.status booking.status) as |st|}}
        <option value='confirmed' {{#if (eq st 'confirmed')}}selected{{/if}}>Confirmed</option>
        <option value='pending' {{#if (eq st 'pending')}}selected{{/if}}>Pending</option>
        <option value='cancelled' {{#if (eq st 'cancelled')}}selected{{/if}}>Cancelled</option>
        <option value='blocked' {{#if (eq st 'blocked')}}selected{{/if}}>Blocked</option>
      {{/with}}
    </select>
  </div>
  <button type='submit'>Save</button>
</form>
<p><a href='/bookings'>Back</a></p>

{{> footer }}