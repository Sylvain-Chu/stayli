{{> header }}
{{> sidebar }}

<h1>{{t 'bookings.editTitle'}}</h1>
{{#if errors}}
  <div class='alert alert-error'>
    <ul>
      {{#each errors}}
        <li>{{this}}</li>
      {{/each}}
    </ul>
  </div>
{{/if}}
<form method='post' action='/bookings/{{booking.id}}/edit'>
  <div>
    <label>{{t 'bookings.property'}}</label>
    <select name='propertyId' required>
      {{#each properties}}
        <option value='{{this.id}}' {{#if (eq this.id (or ../payload.propertyId ../booking.propertyId))}}selected{{/if}}>
          {{this.name}}
        </option>
      {{/each}}
    </select>
  </div>
  <div>
    <label>{{t 'bookings.client'}}</label>
    <select name='clientId' required>
      {{#each clients}}
        <option value='{{this.id}}' {{#if (eq this.id (or ../payload.clientId ../booking.clientId))}}selected{{/if}}>
          {{this.lastName}} {{this.firstName}} - {{this.email}}
        </option>
      {{/each}}
    </select>
  </div>
  <div>
    <label>{{t 'bookings.startDate'}}</label>
    <input type='date' name='startDate' value='{{#if payload.startDate}}{{payload.startDate}}{{else}}{{date booking.startDate}}{{/if}}' required />
  </div>
  <div>
    <label>{{t 'bookings.endDate'}}</label>
    <input type='date' name='endDate' value='{{#if payload.endDate}}{{payload.endDate}}{{else}}{{date booking.endDate}}{{/if}}' required />
  </div>
  <div>
    <label>{{t 'bookings.totalPrice'}}</label>
    <input type='number' step='0.01' name='totalPrice' value='{{#if payload.totalPrice}}{{payload.totalPrice}}{{else}}{{booking.totalPrice}}{{/if}}' />
  </div>
  <div>
    <label>{{t 'bookings.status'}}</label>
    <select name='status'>
      {{#with (or payload.status booking.status) as |st|}}
  <option value='confirmed' {{#if (eq st 'confirmed')}}selected{{/if}}>{{t 'bookings.statusConfirmed'}}</option>
  <option value='pending' {{#if (eq st 'pending')}}selected{{/if}}>{{t 'bookings.statusPending'}}</option>
  <option value='cancelled' {{#if (eq st 'cancelled')}}selected{{/if}}>{{t 'bookings.statusCancelled'}}</option>
  <option value='blocked' {{#if (eq st 'blocked')}}selected{{/if}}>{{t 'bookings.statusBlocked'}}</option>
      {{/with}}
    </select>
  </div>
  <button type='submit'>{{t 'common.save'}}</button>
</form>
<p><a href='/bookings'>{{t 'common.back'}}</a></p>

{{> footer }}