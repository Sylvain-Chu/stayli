{{> header }}
{{> sidebar }}

<h1>Bookings</h1>
<form method='GET' action='/bookings' style='margin: 0 0 1rem;'>
  <label>From
    <input type='date' name='from' value='{{from}}' />
  </label>
  <label style='margin-left:.5rem;'>To
    <input type='date' name='to' value='{{to}}' />
  </label>
  <button type='submit' style='margin-left:.5rem;'>Filter</button>
  {{#if from}}{{#if to}}<a href='/bookings' style='margin-left: .5rem;'>Clear</a>{{/if}}{{/if}}
  <span style='margin-left:1rem;'><a href='/bookings/create'>Create a new booking</a> | <a href='/bookings/calendar'>Open calendar</a></span>
  </form>
<hr />
<ul>
  {{#each bookings}}
    <li>
      <strong>{{this.property.name}}
        —
        {{this.client.firstName}}
        {{this.client.lastName}}</strong><br />
      <small>{{date this.startDate}}
        →
        {{date this.endDate}}
        —
        {{this.totalPrice}}€ —
        {{this.status}}</small>
      <button
        data-delete
        data-id='{{this.id}}'
        data-base='/bookings'
        data-confirm='Delete this booking?'
      >Delete</button>
      {{#unless (eq this.status 'cancelled')}}
        <button
          data-post
          data-url='/bookings/{{this.id}}/cancel'
          data-confirm='Cancel this booking?'
        >Cancel</button>
      {{/unless}}
      <a href='/bookings/{{this.id}}'>View</a>
      <a href='/bookings/{{this.id}}/edit'>Edit</a>
    </li>
  {{else}}
    <li>No bookings yet.</li>
  {{/each}}
</ul>

{{> footer }}