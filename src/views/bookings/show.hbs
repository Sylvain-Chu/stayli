{{> header activeNav="bookings" }}
{{> sidebar activeNav="bookings" }}
<link rel="stylesheet" href="/css/pages/booking-show-modern.css">

<div class="booking-header-bar">
  <div class="booking-breadcrumbs">
    <a href="/bookings">Bookings</a> /
    <span>#BK-{{booking.id}}</span>
  </div>
  <div class="booking-header-main">
    <div>
      <h1 class="booking-title">Booking Details</h1>
    </div>
    <div class="booking-header-actions">
      <button class="booking-action-btn"><i data-feather="edit-2"></i> Edit Booking</button>
      <button class="booking-action-btn secondary"><i data-feather="send"></i> Send Confirmation</button>
      <button class="booking-action-btn danger"><i data-feather="x-circle"></i> Cancel Booking</button>
    </div>
  </div>
</div>

<div class="booking-main-grid">
  <div class="booking-main-left">
    <!-- Reservation Summary Card (modern) -->
    <div class="booking-card summary-card">
      <div class="booking-card-header">Reservation Summary</div>
      <div class="booking-card-content">
        <div class="booking-summary-row">
          <img class="booking-summary-img" src="{{booking.property.imageUrl}}" alt="{{booking.property.name}}" onerror="this.style.display='none'">
          <div>
            <a class="booking-summary-title" href="/properties/{{booking.property.id}}">{{booking.property.name}}</a>
            <div class="booking-summary-address">{{booking.property.address}}</div>
            <button class="booking-summary-btn" onclick="window.location='/properties/{{booking.property.id}}'">View Property</button>
          </div>
        </div>
        <div class="booking-summary-details">
          <div>
            <span class="booking-summary-label">Check-in</span><br>
            <span class="booking-summary-value">{{formatDateShort booking.startDate}}</span>
          </div>
          <div>
            <span class="booking-summary-label">Check-out</span><br>
            <span class="booking-summary-value">{{formatDateShort booking.endDate}}</span>
          </div>
          <div>
            <span class="booking-summary-label">Duration</span><br>
            <span class="booking-summary-value">{{durationNights}} Nights</span>
          </div>
          <div>
            <span class="booking-summary-label">Guests</span><br>
            <span class="booking-summary-value">{{booking.guestsLabel}}</span>
          </div>
        </div>
      </div>
    </div>
    <!-- Financials Card (modern) -->
    <div class="booking-card financials-card">
      <div class="booking-card-header">Financials</div>
      <div class="booking-card-content">
        <div class="booking-financials-grid">
          <div>
            <div class="booking-section-title">Price Breakdown</div>
            <div class="booking-financials-breakdown">
              <div class="flex justify-between"><span class="booking-summary-label">Base Rate</span><span class="booking-summary-value">{{currency booking.totalPrice}}</span></div>
              {{#if booking.cleaningFee}}
              <div class="flex justify-between"><span class="booking-summary-label">Cleaning Fee</span><span class="booking-summary-value">{{currency booking.cleaningFee}}</span></div>
              {{/if}}
              {{#if booking.taxes}}
              <div class="flex justify-between"><span class="booking-summary-label">Taxes & Fees</span><span class="booking-summary-value">{{currency booking.taxes}}</span></div>
              {{/if}}
              <div class="flex justify-between" style="border-top:1px solid #e5e7eb;margin-top:0.7rem;padding-top:0.7rem;"><span class="booking-summary-label" style="font-weight:700;color:#222;">Total Price</span><span class="booking-summary-value" style="font-weight:700;color:#222;">{{currency booking.totalPrice}}</span></div>
            </div>
          </div>
          <div>
            <div class="booking-section-title">Related Invoices</div>
            <div class="overflow-x-auto">
              <table class="booking-card-table">
                <thead><tr><th>INVOICE ID</th><th>AMOUNT</th><th>STATUS</th></tr></thead>
                <tbody>
                  {{#if booking.invoice}}
                  <tr>
                    <td><a href="/invoices/{{booking.invoice.id}}">{{booking.invoice.id}}</a></td>
                    <td>{{currency booking.invoice.amount}}</td>
                    <td><span class="booking-badge {{booking.invoice.status}}">{{capitalize booking.invoice.status}}</span></td>
                  </tr>
                  {{else}}
                  <tr><td colspan="3" style="text-align:center;color:#888;">No invoice</td></tr>
                  {{/if}}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="booking-main-right">
    <!-- Client Information Card -->
    <div class="booking-card">
      <div class="booking-card-header">Client Information</div>
      <div class="booking-card-content">
        <div class="booking-client-info">
          <img class="booking-client-avatar" src="{{booking.client.avatarUrl}}" alt="{{booking.client.firstName}} {{booking.client.lastName}}" onerror="this.style.display='none'">
          <div class="booking-client-details">
            <a class="booking-client-name" href="/clients/{{booking.client.id}}">{{booking.client.firstName}} {{booking.client.lastName}}</a>
            <div class="booking-client-email">{{booking.client.email}}</div>
            <div class="booking-client-phone">{{booking.client.phone}}</div>
          </div>
        </div>
        {{!-- <div class="booking-client-special" style="margin-top:1.2rem;">
          <span style="color:#617c89;font-weight:500;font-size:0.97rem;">Special Requests</span><br>
          <span class="booking-client-special-text">{{booking.client.specialRequests}}</span>
        </div> --}}
      </div>
    </div>
    <!-- Status Card (modern) -->
    <div class="booking-card status-card">
      <div class="booking-card-header">Status</div>
      <div class="booking-card-content">
        <div class="booking-status-block">
          <div class="booking-status-label">Booking Status</div>
          <div class="booking-badge {{booking.status}}"><i data-feather="check-circle" style="font-size:1em;"></i> {{capitalize booking.status}}</div>
        </div>
        <div class="booking-status-block">
          <div class="booking-status-label">Payment Status</div>
          {{#if booking.invoice}}
            <div class="booking-badge {{booking.invoice.status}}"><i data-feather="credit-card" style="font-size:1em;"></i> {{capitalize booking.invoice.status}}</div>
          {{else}}
            <div class="booking-badge">No invoice</div>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
</div>
{{> footer}}