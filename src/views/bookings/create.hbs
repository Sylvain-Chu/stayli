{{> header }}
{{> sidebar }}

<div class="page-header">
  <div>
    <a href='/bookings' class="breadcrumb">
      <i data-feather="arrow-left"></i>
      {{t 'bookings.title'}}
    </a>
    <h1>{{t 'bookings.createTitle'}}</h1>
  </div>
</div>

{{#if errors}}
  <div class='alert alert-error'>
    <ul>
      {{#each errors}}
        <li>{{this}}</li>
      {{/each}}
    </ul>
  </div>
{{/if}}

<div class="form-card">
  <form method='post' action='/bookings/create' class="form-layout">
    
    <div class="form-section">
      <h3 class="form-section-title">
        <i data-feather="map-pin"></i>
        {{t 'bookings.propertyAndClient'}}
      </h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="propertyId">{{t 'bookings.property'}}</label>
          <select name='propertyId' id='propertyId' required>
            <option value='' disabled {{#unless payload.propertyId}}selected{{/unless}}>{{t 'bookings.selectProperty'}}</option>
            {{#each properties}}
              <option value='{{this.id}}' {{#if (eq this.id ../payload.propertyId)}}selected{{/if}}>{{this.name}}</option>
            {{/each}}
          </select>
        </div>

        <div class="form-group">
          <label for="clientId">{{t 'bookings.client'}}</label>
          <select name='clientId' id='clientId' required>
            <option value='' disabled {{#unless payload.clientId}}selected{{/unless}}>{{t 'bookings.selectClient'}}</option>
            {{#each clients}}
              <option value='{{this.id}}' {{#if (eq this.id ../payload.clientId)}}selected{{/if}}>{{this.lastName}} {{this.firstName}}</option>
            {{/each}}
          </select>
        </div>
      </div>
    </div>

    <div class="form-section">
      <h3 class="form-section-title">
        <i data-feather="calendar"></i>
        {{t 'bookings.datesAndPrice'}}
      </h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="startDate">{{t 'bookings.startDate'}}</label>
          <input type='date' name='startDate' id='startDate' value='{{payload.startDate}}' required />
        </div>

        <div class="form-group">
          <label for="endDate">{{t 'bookings.endDate'}}</label>
          <input type='date' name='endDate' id='endDate' value='{{payload.endDate}}' required />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="totalPrice">{{t 'bookings.totalPrice'}}</label>
          <div class="input-with-icon">
            <i data-feather="dollar-sign"></i>
            <input type='number' step='0.01' name='totalPrice' id='totalPrice' value='{{payload.totalPrice}}' placeholder="0.00" required />
          </div>
        </div>

        <div class="form-group">
          <label for="status">{{t 'bookings.status'}}</label>
          <select name='status' id='status'>
            <option value='pending' selected>{{t 'bookings.statusPending'}}</option>
            <option value='confirmed'>{{t 'bookings.statusConfirmed'}}</option>
            <option value='blocked'>{{t 'bookings.statusBlocked'}}</option>
          </select>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <a href='/bookings' class="btn btn-ghost">
        {{t 'common.cancel'}}
      </a>
      <button type='submit' class="btn btn-primary">
        <i data-feather="plus"></i>
        {{t 'common.create'}}
      </button>
    </div>
  </form>
</div>

{{> footer }}